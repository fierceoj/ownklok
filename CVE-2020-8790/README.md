# CVE-2020-8790
>The OKLOK (3.1.1) mobile companion app for Fingerprint Bluetooth Padlock FB50 (2.3) has weak password requirements combined with improper restriction of excessive authentication attempts, which could allow a remote attacker to discover user credentials and obtain access via a brute force attack.

## ownklok_bf.py
>PoC to demonstrate "CWE-307: Improper Restrictions on Excessive Authentication Attempts" on the OKLOK (3.1.1) mobile app. It runs through 1000 intentional bad login attempts before successfully logging in with the known password on the 1001st try. The user inputs the real password before the login requests are sent, so this script is not designed to actually discover passwords. 

## ownklok_bf_crack.py
>PoC code to discover passwords via brute force logins against the OKLOK (3.1.1) mobile app. A wordlist must be supplied.

**Note:** OKLOK passwords can range from 6 to 15 alphanumeric characters. Special characters are not allowed. 

## Usage
```python3 ownklok_bf.py <victim_email_address>``` <br/>
```python3 ownklok_bf_crack.py <victim_email_address> <wordlist_filename>```

`<victim_email_address>` = the email address of the user account you want to brute force <br/>
`<wordlist_filename>` = path to the wordlist you want to use for brute force

**DISCLAIMER** Use these scripts only against user accounts you own or have permission to test.

## Demos
Both demos illustrate a brute force simulation against a dummy "victim" account that was created with a common password from Kali Linux's rockyou.txt wordlist. Some details are redacted in the demos. 

### ownklok_bf.py demo
The ownklok_bf.py demo shows 1000 consecutive login failures through the API, followed by a successful login. The outcome demonstrates "CWE-307: Improper Restrictions on Excessive Authentication Attempts" but does not actually discover the password via brute force. The total execution time will vary depending on your setup. Chunksize may need to be adjusted for your purposes.


### ownklok_bf_crack.py demo
The ownklok_bf_crack.py demo shows a brute force password crack, which guesses passwords from a wordlist until the password is found. The wordlist used here is a subset of Kali Linux's rockyou.txt wordlist. The total execution time will vary depending on your setup. Chunksize may need to be adjusted for your purposes.
