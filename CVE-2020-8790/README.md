# CVE-2020-8790
>The OKLOK (3.1.1) mobile companion app for Fingerprint Bluetooth Padlock FB50 (2.3) has weak password requirements combined with improper restriction of excessive authentication attempts, which could allow a remote attacker to discover user credentials and obtain access via a brute force attack.

## ownklok_bf.py
>PoC to demonstrate "CWE-307: Improper Restrictions on Excessive Authentication Attempts" on the OKLOK (3.1.1) mobile app. It runs through 100 intentional bad login attempts before successfully logging in with the known password on the 101st try. The user inputs the real password, so this script is not designed to actually discover passwords. 

## ownklok_bf_crack.py
>PoC code for brute force logins on the OKLOK (3.1.1) mobile app. See the demo wordlist "wordlist_bf_crack.txt".

## wordlist_bf_crack.txt
>A demo wordlist containing all possible 6-digit non-repeating permutations.

**Note:** OKLOK passwords can range from 6 to 15 alphanumeric characters. Special characters are not allowed. A traditional wordlist be more practical, but I have used a 6-digit non-repeating password for PoC/demonstration purposes.

## Usage
```python3 ownklok_bf.py <victim_email_address>``` <br/>
```python3 ownklok_bf_crack.py <victim_email_address> <wordlist_filename>```

`<victim_email_address>` = the email address of the user account you want to brute force
`<wordlist_filename>` = path to the wordlist you want to use for brute force

**DISCLAIMER** Use these scripts only against user accounts you own.

## Demos
Both demos illustrate a brute force simulation against a dummy "victim" account that was created with the 6-digit non-repeating password "". Details are redacted in the demos. 

### ownklok_bf.py demo
The ownklok_bf.py demo shows 100 consecutive login requests through the API, followed by a successful login. The password is given as user input to the script, so the outcome demonstrates "CWE-307: Improper Restrictions on Excessive Authentication Attempts" but does not discover the password via brute force. The total execution time will vary depending on your setup. 


### ownklok_bf_crack.py demo
The ownklok_bf_crack.py demo shows a brute force password crack, which guesses 6-digit non-repeating permutations until the password is found. The total execution time will vary depending on your setup. Chunksize may need to be adjusted for your purposes.
