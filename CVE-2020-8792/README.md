# CVE-2020-8792
>The OKLOK (3.1.1) mobile companion app for Fingerprint Bluetooth Padlock FB50 (2.3) has an information-exposure issue. An attempt to add an already-bound lock by its barcode in the app reveals the email address of the account to which the lock is bound, as well as the name of the lock. Valid barcode inputs can be easily guessed because barcode strings follow a predictable pattern. Correctly guessed valid barcode inputs entered through the app interface disclose arbitrary users' email addresses and lock names. 

**Note:** This vulnerability can be chained with CVE-2020-8791 in order to retrieve additional user account information for any list of arbitrary barcodes.

## Mobile App Interface Disclosure
>Attempt to add an already-bound lock by manually entering its barcode into "Add by ID No." in the app. The app will display the email address of the account to which the lock is bound, as well as the lock name assigned by the owner. (See ownklok/CVE-2020-8792/mobile_app_interface_disclosure for reproducible steps.)

<img src=../screenshots/mobile_app_info_disclosure_step1.PNG width="250">

## ownklok_barcode.py
>Construct valid barcodes from arbitrary numeric range inputs and discover account email addresses and lock names.

## ownklok_chain.py
>Chain CVE-2020-8792 and CVE-2020-8791 to collect email addresses, unsalted MD5 password hashes, owner-assigned lock names, owner-assigned fingerprint names, and more, for any range of arbitrary barcodes.

## Usage
```python3 ownklok_barcode.py <start_of_range> <end_of_range> <attacker_email_address>``` <br/>
```python3 ownklok_chain.py <start_of_range> <end_of_range> <attacker_email_address>```

`<start_of_range>` = the first number to try for barcode construction <br/>
`<end_of_range>` = the upper bound of the range for barcode guesses (non-inclusive) <br/>
`<attacker_email_address>` = the email address of the attacker account, which will be used to generate an accepted token for the HTTP headers

## Demos
